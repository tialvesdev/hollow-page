<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Editar Perfil</title>
    <link rel="shortcut icon" href="../assets/img/icon/hollow-icon.ico" type="image/x-icon">

    <link rel="stylesheet" href="../assets/css/global.style.css">
    <link rel="stylesheet" href="../assets/css/edit-style.css">

    <script src="../assets/js/session.js"></script>

</head>
<body>
    
    <div class="edit-wrapper">
        <div class="edit-content">
            <div class="edit-header">
                <a href="./profile.html" class="seta-voltar seta-float">
                    <img src="../assets/img/icon/arrow-icon.png" alt="Voltar">
                  </a>
                  <h1 class="title">Editar Perfil</h1>
            </div>
            <div class="edit-main">
                <div class="edit-sect">
                    <div class="edit-aside">
                        <p class="text edit-subtitle">Dados Pessoais: </p>
                        <input type="text" id="ipt_edit_nome" class="ipt" placeholder="Jão">
                        <input type="text" id="ipt_edit_email" class="ipt" placeholder="fulano@gmail.com">
                        <input type="date" id="ipt_edit_date" class="ipt">
                    </div>
                    <div class="edit-aside">
                        <img id="edit_prof_img" src="" alt="Foto de Perfil" class="edit-prof-img">
                        <p id="edit_prof_img_name" class="text edit-text"> <b> Nenhuma foto selecionada </b> </p>
                        <label for="ipt_edit_prof_pic">
                            <input class="sumir" type="file" name="ipt_edit_prof_pic" id="ipt_edit_prof_pic">
                            <a class="big-text">
                                <b> Importar Foto </b>
                            </a>
                        </label>

                        <!-- <img src="../assets/img/char/knight-crying.png" alt="Nenhuma foto selecionada" class="ipt-file-img" id="ipt_file_img">
                        <p class="text ipt-file-name" id="ipt_ile_name">Nenhuma foto selecionada</p>
                        <label for="ipt_file" class="ipt-file-label">
                            <input class="ipt-file sumir" type="file" id="ipt_file" name="ipt_file" accept="image/*"
                            onchange="previewImage(event)" />
                            <a class="ipt-file-a big-text"><b> Escolher foto </b></a>
                        </label> -->
                    </div>
                </div>
                <hr class="divider">
                <div class="edit-sect">
                    <div class="edit-aside">
                        <p class="text edit-subtitle">Dados Adicionais: </p>
                        <input type="text" id="ipt_edit_genero" class="ipt" placeholder="Gênero">
                        <input type="text" id="ipt_edit_telefone" class="ipt" placeholder="Telefone">
                    </div>
                    <div class="edit-aside">
                        <img id="edit_prof_bg" src="" alt="Foto de Capa" class="edit-prof-bg">
                        <p id="edit_prof_bg_name" class="text edit-text"> <b> Nenhuma foto selecionada </b> </p>
                        <select name="sel_prof_bg" id="sel_prof_bg"></select>
                    </div>
                </div>
            </div>
            <button class="btn" onclick="">Editar</button>
        </div>
    </div>

</body>
</html>

<script>

window.onload = loadProfile()
    
    function loadProfile() {

        validarSessao();

        var profPosts = document.getElementById('prof_posts')

        fetch(`/usuarios/profile/${sessionStorage.ID_USUARIO}`, {
            method: "GET"
        })
            .then(res => {
                console.log(res);
                res.json().then(json => {
                    console.log(json);
                    usuario = json;

                    if (json[0].fotoPerfilSrc == null) {
                        document.getElementById('edit_prof_img').src = `../assets/img/icon/user-icon.png"`;                 
                    } else {
                        document.getElementById('edit_prof_img').src = `../assets/bucket/${json[0].fotoPerfilSrc}`;
                        document.getElementById('edit_prof_img_name').innerHTML = '<b> Foto de Perfil </b>';
                    }

                    document.getElementById('ipt_edit_nome').value = json[0].nome;
                    document.getElementById('ipt_edit_email').value = json[0].email;
                    document.getElementById('ipt_edit_date').value = json[0].dtNasc;

                    if (json[0].tel != null) {
                        document.getElementById('ipt_edit_telefone').value = json[0].tel;
                    }

                    document.getElementById('edit_prof_bg').src = `../assets/img/profile/${json[0].fundoSrc}`;
                    document.getElementById('edit_prof_bg_name').innerHTML = `<b> Fundo de perfil: ${json[0].nomeFundoPerfil} </b>`;

                    
                })
            })
            .catch(err => {
                console.log(err);
            })

    }

</script>